(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4171],{5360:(e,a,s)=>{"use strict";function t(){{let e=sessionStorage.getItem("admin_token");return console.log(e),e}}async function r(e){let a=t(),s=new FormData;Object.entries(e).forEach(e=>{let[a,t]=e;s.append(a,t)});let r=await fetch("".concat("https://live.maypascollege.com","/api/v1/contents/category/create"),{method:"POST",headers:{Authorization:"Bearer ".concat(a),Accept:"application/json"},body:s});if(console.log(r),!r.ok)throw Error("Failed to create category");return r.json()}async function d(){let e=t(),a=await fetch("".concat("https://live.maypascollege.com","/api/v1/course/categories"),{headers:{Authorization:"Bearer ".concat(e)}});if(!a.ok)throw Error("Failed to fetch categories");return a.json()}async function c(e,a){let s=t(),r=new FormData;Object.entries(a).forEach(e=>{let[a,s]=e;r.append(a,s)});let d=await fetch("".concat("https://live.maypascollege.com","/api/v1/contents/category/update/").concat(e),{method:"POST",headers:{Authorization:"Bearer ".concat(s),Accept:"application/json"},body:r});if(!d.ok)throw Error("Failed to update category");return d.json()}async function n(e){let a=t(),s=await fetch("".concat("https://live.maypascollege.com","/api/v1/contents/category/delete/").concat(e),{method:"POST",headers:{Authorization:"Bearer ".concat(a),"Content-Type":"application/json"}});if(!s.ok)throw Error("Failed to delete category");return s.json()}s.d(a,{K7:()=>n,bW:()=>d,st:()=>c,zZ:()=>r})},6689:()=>{},7353:(e,a,s)=>{"use strict";s.r(a),s.d(a,{default:()=>x});var t=s(7876),r=s(1703),d=s.n(r),c=s(4232),n=s(2603),i=s(6427);function o(e){let{categories:a,onEdit:s,onDelete:r}=e;return(0,t.jsxs)("div",{className:"jsx-ac461a408b00b81b table-responsive",children:[(0,t.jsxs)("table",{className:"jsx-ac461a408b00b81b admin-table",children:[(0,t.jsx)("thead",{className:"jsx-ac461a408b00b81b",children:(0,t.jsxs)("tr",{className:"jsx-ac461a408b00b81b",children:[(0,t.jsx)("th",{className:"jsx-ac461a408b00b81b",children:"Image"}),(0,t.jsx)("th",{className:"jsx-ac461a408b00b81b",children:"Name"}),(0,t.jsx)("th",{className:"jsx-ac461a408b00b81b",children:"Excerpt"}),(0,t.jsx)("th",{className:"jsx-ac461a408b00b81b",children:"Description"}),(0,t.jsx)("th",{className:"jsx-ac461a408b00b81b",children:"Actions"})]})}),(0,t.jsxs)("tbody",{className:"jsx-ac461a408b00b81b",children:[0===a.length&&(0,t.jsx)("tr",{className:"jsx-ac461a408b00b81b",children:(0,t.jsx)("td",{colSpan:5,style:{textAlign:"center"},className:"jsx-ac461a408b00b81b",children:"No programmes found."})}),a.map(e=>(0,t.jsxs)("tr",{className:"jsx-ac461a408b00b81b",children:[(0,t.jsx)("td",{className:"jsx-ac461a408b00b81b",children:e.featured_image_path?(0,t.jsx)("img",{src:"https://live.maypascollege.com/storage/"+e.featured_image_path,alt:"",style:{width:60,borderRadius:6},className:"jsx-ac461a408b00b81b"}):(0,t.jsx)("span",{style:{color:"#aaa"},className:"jsx-ac461a408b00b81b",children:"No image"})}),(0,t.jsx)("td",{className:"jsx-ac461a408b00b81b",children:e.name}),(0,t.jsx)("td",{className:"jsx-ac461a408b00b81b",children:e.excerpt}),(0,t.jsx)("td",{className:"jsx-ac461a408b00b81b",children:e.description}),(0,t.jsxs)("td",{className:"jsx-ac461a408b00b81b",children:[(0,t.jsx)("button",{onClick:()=>s(e),className:"jsx-ac461a408b00b81b edit-btn",children:"Edit"}),(0,t.jsx)("button",{onClick:()=>r(e.id),className:"jsx-ac461a408b00b81b delete-btn",children:"Delete"})]})]},e.id))]})]}),(0,t.jsx)(d(),{id:"ac461a408b00b81b",children:".table-responsive.jsx-ac461a408b00b81b{overflow-x:auto}.admin-table.jsx-ac461a408b00b81b{width:100%;border-collapse:collapse;background:#fff;margin-top:1rem}th.jsx-ac461a408b00b81b,td.jsx-ac461a408b00b81b{padding:.75rem 1rem;border-bottom:1px solid#eee}th.jsx-ac461a408b00b81b{background:#f7f8fa}.edit-btn.jsx-ac461a408b00b81b,.delete-btn.jsx-ac461a408b00b81b{margin-right:.5rem;padding:.4rem 1rem;border:none;border-radius:4px;font-size:.95rem;cursor:pointer}.edit-btn.jsx-ac461a408b00b81b{background:#4f8cff;color:#fff}.delete-btn.jsx-ac461a408b00b81b{background:#ff4f4f;color:#fff}@media(max-width:600px){th.jsx-ac461a408b00b81b,td.jsx-ac461a408b00b81b{padding:.5rem .3rem;font-size:.9rem}.edit-btn.jsx-ac461a408b00b81b,.delete-btn.jsx-ac461a408b00b81b{padding:.3rem .7rem;font-size:.85rem}}"})]})}function l(e){let{initial:a,onSubmit:s,onCancel:r,loading:n}=e,[i,o]=(0,c.useState)(a||{name:"",excerpt:"",description:"",featured_image:null});(0,c.useEffect)(()=>{a&&o(a)},[a]);let[l,b]=(0,c.useState)({}),[m,x]=(0,c.useState)((null==a?void 0:a.featured_image)||""),j=(0,c.useRef)(),f=e=>{let{name:a,value:s}=e.target;o(e=>({...e,[a]:s}))};return(0,t.jsxs)("form",{onSubmit:e=>{e.preventDefault(),(()=>{let e={};return i.name||(e.name="Name is required"),i.excerpt||(e.excerpt="Excerpt is required"),i.description||(e.description="Description is required"),b(e),0===Object.keys(e).length})()&&s(i)},className:"jsx-ad4d1b9d095121e0 admin-form",children:[(0,t.jsxs)("div",{className:"jsx-ad4d1b9d095121e0",children:[(0,t.jsx)("label",{className:"jsx-ad4d1b9d095121e0",children:"Name"}),(0,t.jsx)("input",{name:"name",value:i.name,onChange:f,required:!0,className:"jsx-ad4d1b9d095121e0"}),l.name&&(0,t.jsx)("span",{className:"jsx-ad4d1b9d095121e0 err",children:l.name})]}),(0,t.jsxs)("div",{className:"jsx-ad4d1b9d095121e0",children:[(0,t.jsx)("label",{className:"jsx-ad4d1b9d095121e0",children:"Excerpt"}),(0,t.jsx)("input",{name:"excerpt",value:i.excerpt,onChange:f,required:!0,className:"jsx-ad4d1b9d095121e0"}),l.excerpt&&(0,t.jsx)("span",{className:"jsx-ad4d1b9d095121e0 err",children:l.excerpt})]}),(0,t.jsxs)("div",{className:"jsx-ad4d1b9d095121e0",children:[(0,t.jsx)("label",{className:"jsx-ad4d1b9d095121e0",children:"Description"}),(0,t.jsx)("textarea",{name:"description",value:i.description,onChange:f,rows:3,required:!0,className:"jsx-ad4d1b9d095121e0"}),l.description&&(0,t.jsx)("span",{className:"jsx-ad4d1b9d095121e0 err",children:l.description})]}),(0,t.jsxs)("div",{className:"jsx-ad4d1b9d095121e0",children:[(0,t.jsx)("label",{className:"jsx-ad4d1b9d095121e0",children:"Featured Image"}),(0,t.jsx)("input",{type:"file",accept:"image/*",ref:j,onChange:e=>{let a=e.target.files[0];a&&a.type.startsWith("image/")?(o(e=>({...e,featured_image:a})),x(URL.createObjectURL(a))):b(e=>({...e,featured_image:"Only image files allowed"}))},className:"jsx-ad4d1b9d095121e0"}),m&&(0,t.jsx)("img",{src:m,alt:"preview",style:{width:100,marginTop:8,borderRadius:6},className:"jsx-ad4d1b9d095121e0"}),l.featured_image&&(0,t.jsx)("span",{className:"jsx-ad4d1b9d095121e0 err",children:l.featured_image})]}),(0,t.jsxs)("div",{className:"jsx-ad4d1b9d095121e0 form-actions",children:[(0,t.jsx)("button",{type:"submit",disabled:n,className:"jsx-ad4d1b9d095121e0 save-btn",children:n?a?"Updating Programme...":"Creating Programme...":"Proceed"}),r&&(0,t.jsx)("button",{type:"button",onClick:r,disabled:n,style:n?{background:"#f0f0f0",color:"#aaa",cursor:"not-allowed"}:{},className:"jsx-ad4d1b9d095121e0 cancel-btn",children:"Cancel"})]}),(0,t.jsx)(d(),{id:"ad4d1b9d095121e0",children:".admin-form.jsx-ad4d1b9d095121e0{background:#fff;padding:2rem;border-radius:8px;box-shadow:0 2px 8px rgba(0,0,0,.04);margin-bottom:2rem}label.jsx-ad4d1b9d095121e0{display:block;font-weight:500;margin-bottom:.4rem}input.jsx-ad4d1b9d095121e0,textarea.jsx-ad4d1b9d095121e0{width:100%;padding:.6rem;border:1px solid#e0e0e0;border-radius:4px;margin-bottom:1rem;font-size:1rem}.form-actions.jsx-ad4d1b9d095121e0{display:flex;gap:1rem}.save-btn.jsx-ad4d1b9d095121e0{background:#4f8cff;color:#fff;border:none;padding:.7rem 2rem;border-radius:4px;font-weight:600;cursor:pointer}.save-btn[disabled].jsx-ad4d1b9d095121e0{background:#b3d1ff!important;color:#fff!important;cursor:not-allowed!important}.cancel-btn.jsx-ad4d1b9d095121e0{background:#eee;color:#222;border:none;padding:.7rem 2rem;border-radius:4px;font-weight:600;cursor:pointer}.cancel-btn[disabled].jsx-ad4d1b9d095121e0{background:#f0f0f0!important;color:#aaa!important;cursor:not-allowed!important}.err.jsx-ad4d1b9d095121e0{color:#ff4f4f;font-size:.95em}"})]})}var b=s(5360),m=s(4301);function x(){let[e,a]=(0,c.useState)([]),[s,r]=(0,c.useState)(null),[x,j]=(0,c.useState)(!1),[f,p]=(0,c.useState)(!0),[u,h]=(0,c.useState)(!1),[g,y]=(0,c.useState)("");(0,c.useEffect)(()=>{p(!0),(0,b.bW)().then(e=>{a(Array.isArray(e)?e:Array.isArray(null==e?void 0:e.data)?e.data:[]),y("")}).catch(()=>{y("Failed to fetch course programmes. Please try again later."),a([])}).finally(()=>p(!1))},[]);let N=async s=>{if(confirm("Delete this programme?")){h(!0);try{await (0,b.K7)(s);let e=await (0,b.bW)();a(Array.isArray(e)?e:e.data||[]),m.oR.success("Programme deleted successfully")}catch(e){m.oR.error("Failed to delete programme")}finally{h(!1)}a(e.filter(e=>e.id!==s))}},w=async e=>{h(!0);try{if(s){await (0,b.st)(s.id,e);let t=await (0,b.bW)();a(Array.isArray(t)?t:t.data||[]),m.oR.success("Programme updated successfully")}else{await (0,b.zZ)(e);let s=await (0,b.bW)();a(Array.isArray(s)?s:s.data||[]),m.oR.success("Programme created successfully")}j(!1),r(null)}catch(e){m.oR.error("Failed to save Programme: "+(null==e?void 0:e.message))}finally{h(!1)}};return(0,t.jsx)(n.A,{children:(0,t.jsxs)("div",{className:"jsx-93d6c34771d4e297 admin-layout",children:[(0,t.jsx)(i.A,{}),(0,t.jsxs)("main",{className:"jsx-93d6c34771d4e297",children:[(0,t.jsx)(m.N9,{position:"top-right",autoClose:3e3}),(0,t.jsxs)("div",{className:"jsx-93d6c34771d4e297 admin-header",children:[(0,t.jsx)("h1",{className:"jsx-93d6c34771d4e297",children:"Programmes"}),!x&&(0,t.jsx)("button",{onClick:()=>{r(null),j(!0)},disabled:u,style:u?{opacity:.6,pointerEvents:"none"}:{},className:"jsx-93d6c34771d4e297 add-btn",children:u&&!x?"Loading...":"+ Add Program"})]}),x&&(0,t.jsx)(l,{initial:s,onSubmit:w,onCancel:()=>{j(!1),r(null)},loading:u}),g&&(0,t.jsx)("div",{style:{color:"#ff4f4f",marginBottom:"1rem",textAlign:"center"},className:"jsx-93d6c34771d4e297",children:g}),(0,t.jsx)(o,{categories:e,onEdit:e=>{r(e),j(!0)},onDelete:N,actionLoading:u}),f&&(0,t.jsx)("div",{style:{position:"absolute",left:0,top:0,width:"100%",height:"100%",background:"rgba(255,255,255,0.7)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:10},className:"jsx-93d6c34771d4e297",children:(0,t.jsx)("div",{style:{fontSize:18},className:"jsx-93d6c34771d4e297",children:"Loading..."})})]}),(0,t.jsx)(d(),{id:"93d6c34771d4e297",children:".admin-layout.jsx-93d6c34771d4e297{display:flex;min-height:100vh;background:#f5f7fb}main.jsx-93d6c34771d4e297{flex:1;padding:2rem}.admin-header.jsx-93d6c34771d4e297{display:flex;justify-content:space-between;align-items:center;margin-bottom:2rem}.add-btn.jsx-93d6c34771d4e297{background:#4f8cff;color:#fff;border:none;padding:.7rem 2rem;border-radius:4px;font-weight:600;cursor:pointer;font-size:1rem}.add-btn[disabled].jsx-93d6c34771d4e297{opacity:.6;cursor:not-allowed}@media(max-width:900px){main.jsx-93d6c34771d4e297{padding:1rem;width:70%}}"})]})})}s(6689)},9760:(e,a,s)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/admin/courseCategory",function(){return s(7353)}])}},e=>{e.O(0,[4938,9008,3835,1978,636,6593,8792],()=>e(e.s=9760)),_N_E=e.O()}]);