(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2735],{2871:(e,a,t)=>{"use strict";function s(){return sessionStorage.getItem("admin_token")}async function r(){let e=s(),a=await fetch("".concat("https://live.maypascollege.com","/api/v1/blogs/get"),{headers:{Authorization:"Bearer ".concat(e)}});if(!a.ok)throw Error("Failed to fetch blogs");let t=await a.json();return Array.isArray(t)?t:t.data||[]}async function l(e){let a=s(),t=new FormData;for(let a of(Object.entries(e).forEach(e=>{let[a,s]=e;t.append(a,s)}),t.entries()))console.log("FormData:",a[0],":",a[1]);let r=await fetch("".concat("https://live.maypascollege.com","/api/v1/contents/blog/create"),{method:"POST",headers:{Authorization:"Bearer ".concat(a)},body:t});if(!r.ok)throw Error("Failed to create blog");return r.json()}async function n(e,a){let t=s(),r=new FormData;Object.entries(a).forEach(e=>{let[a,t]=e;r.append(a,t)});let l=await fetch("".concat("https://live.maypascollege.com","/api/v1/contents/blog/update/").concat(e),{method:"POST",headers:{Authorization:"Bearer ".concat(t)},body:r});if(!l.ok)throw Error("Failed to update blog");return l.json()}async function c(e){let a=s(),t=await fetch("".concat("https://live.maypascollege.com","/api/v1/contents/blog/delete/").concat(e),{method:"POST",headers:{Authorization:"Bearer ".concat(a)}});if(!t.ok)throw Error("Failed to delete blog");return t.json()}t.d(a,{$5:()=>l,c5:()=>n,cc:()=>c,kz:()=>r})},3954:(e,a,t)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/admin/blogs",function(){return t(6969)}])},6689:()=>{},6969:(e,a,t)=>{"use strict";t.r(a),t.d(a,{default:()=>m});var s=t(7876),r=t(1703),l=t.n(r),n=t(4232),c=t(2603),i=t(6427);function o(e){let{blogs:a,onEdit:t,onDelete:r}=e;return(0,s.jsxs)("div",{className:"jsx-ac461a408b00b81b table-responsive",children:[(0,s.jsxs)("table",{className:"jsx-ac461a408b00b81b admin-table",children:[(0,s.jsx)("thead",{className:"jsx-ac461a408b00b81b",children:(0,s.jsxs)("tr",{className:"jsx-ac461a408b00b81b",children:[(0,s.jsx)("th",{className:"jsx-ac461a408b00b81b",children:"Image"}),(0,s.jsx)("th",{className:"jsx-ac461a408b00b81b",children:"Title"}),(0,s.jsx)("th",{className:"jsx-ac461a408b00b81b",children:"Slug"}),(0,s.jsx)("th",{className:"jsx-ac461a408b00b81b",children:"Content"}),(0,s.jsx)("th",{className:"jsx-ac461a408b00b81b",children:"Actions"})]})}),(0,s.jsxs)("tbody",{className:"jsx-ac461a408b00b81b",children:[0===a.length&&(0,s.jsx)("tr",{className:"jsx-ac461a408b00b81b",children:(0,s.jsx)("td",{colSpan:5,style:{textAlign:"center"},className:"jsx-ac461a408b00b81b",children:"No blogs found."})}),a.map(e=>(0,s.jsxs)("tr",{className:"jsx-ac461a408b00b81b",children:[(0,s.jsx)("td",{className:"jsx-ac461a408b00b81b",children:e.featured_image_path?(0,s.jsx)("img",{src:"https://live.maypascollege.com/storage/"+e.featured_image_path,alt:"",style:{width:60,borderRadius:6},className:"jsx-ac461a408b00b81b"}):(0,s.jsx)("span",{style:{color:"#aaa"},className:"jsx-ac461a408b00b81b",children:"No image"})}),(0,s.jsx)("td",{className:"jsx-ac461a408b00b81b",children:e.title}),(0,s.jsx)("td",{className:"jsx-ac461a408b00b81b",children:e.slug}),(0,s.jsx)("td",{style:{maxWidth:200,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},className:"jsx-ac461a408b00b81b",children:e.content}),(0,s.jsxs)("td",{className:"jsx-ac461a408b00b81b",children:[(0,s.jsx)("button",{onClick:()=>t(e),className:"jsx-ac461a408b00b81b edit-btn",children:"Edit"}),(0,s.jsx)("button",{onClick:()=>r(e.id),className:"jsx-ac461a408b00b81b delete-btn",children:"Delete"})]})]},e.id))]})]}),(0,s.jsx)(l(),{id:"ac461a408b00b81b",children:".table-responsive.jsx-ac461a408b00b81b{overflow-x:auto}.admin-table.jsx-ac461a408b00b81b{width:100%;border-collapse:collapse;background:#fff;margin-top:1rem}th.jsx-ac461a408b00b81b,td.jsx-ac461a408b00b81b{padding:.75rem 1rem;border-bottom:1px solid#eee}th.jsx-ac461a408b00b81b{background:#f7f8fa}.edit-btn.jsx-ac461a408b00b81b,.delete-btn.jsx-ac461a408b00b81b{margin-right:.5rem;padding:.4rem 1rem;border:none;border-radius:4px;font-size:.95rem;cursor:pointer}.edit-btn.jsx-ac461a408b00b81b{background:#4f8cff;color:#fff}.delete-btn.jsx-ac461a408b00b81b{background:#ff4f4f;color:#fff}@media(max-width:600px){th.jsx-ac461a408b00b81b,td.jsx-ac461a408b00b81b{padding:.5rem .3rem;font-size:.9rem}.edit-btn.jsx-ac461a408b00b81b,.delete-btn.jsx-ac461a408b00b81b{padding:.3rem .7rem;font-size:.85rem}}"})]})}function d(e){let{initial:a,onSubmit:t,onCancel:r,loading:c}=e,[i,o]=(0,n.useState)(a||{title:"",slug:"",content:"",featured_image_path:null});(0,n.useEffect)(()=>{a&&o(a)},[a]);let[d,b]=(0,n.useState)({}),[f,m]=(0,n.useState)((null==a?void 0:a.student_photo)?a.featured_image_path.startsWith("http")?a.featured_image_path:"https://live.maypascollege.com/storage/"+a.student_photo:""),x=(0,n.useRef)(),j=e=>{let{name:a,value:t}=e.target;o(e=>({...e,[a]:t}))};return(0,s.jsxs)("form",{onSubmit:e=>{e.preventDefault(),(()=>{let e={};return i.title||(e.title="Title is required"),i.slug||(e.slug="Slug is required"),i.content||(e.content="Content is required"),b(e),0===Object.keys(e).length})()&&t(i)},className:"jsx-22d92177857556b4 admin-form",children:[(0,s.jsxs)("div",{className:"jsx-22d92177857556b4",children:[(0,s.jsx)("label",{className:"jsx-22d92177857556b4",children:"Title"}),(0,s.jsx)("input",{name:"title",value:i.title,onChange:j,required:!0,className:"jsx-22d92177857556b4"}),d.title&&(0,s.jsx)("span",{className:"jsx-22d92177857556b4 err",children:d.title})]}),(0,s.jsxs)("div",{className:"jsx-22d92177857556b4",children:[(0,s.jsx)("label",{className:"jsx-22d92177857556b4",children:"Slug"}),(0,s.jsx)("input",{name:"slug",value:i.slug,onChange:j,required:!0,className:"jsx-22d92177857556b4"}),d.slug&&(0,s.jsx)("span",{className:"jsx-22d92177857556b4 err",children:d.slug})]}),(0,s.jsxs)("div",{className:"jsx-22d92177857556b4",children:[(0,s.jsx)("label",{className:"jsx-22d92177857556b4",children:"Content"}),(0,s.jsx)("textarea",{name:"content",value:i.content,onChange:j,rows:3,required:!0,className:"jsx-22d92177857556b4"}),d.content&&(0,s.jsx)("span",{className:"jsx-22d92177857556b4 err",children:d.content})]}),(0,s.jsxs)("div",{className:"jsx-22d92177857556b4",children:[(0,s.jsx)("label",{className:"jsx-22d92177857556b4",children:"Featured Image"}),(0,s.jsx)("input",{type:"file",accept:"image/*",ref:x,onChange:e=>{let a=e.target.files[0];a&&a.type.startsWith("image/")?(o(e=>({...e,featured_image_path:a})),m(URL.createObjectURL(a))):b(e=>({...e,featured_image_path:"Only image files allowed"}))},className:"jsx-22d92177857556b4"}),f&&(0,s.jsx)("img",{src:f,alt:"preview",style:{width:100,marginTop:8,borderRadius:6},className:"jsx-22d92177857556b4"}),d.featured_image_path&&(0,s.jsx)("span",{className:"jsx-22d92177857556b4 err",children:d.featured_image_path})]}),(0,s.jsxs)("div",{className:"jsx-22d92177857556b4 form-actions",children:[(0,s.jsx)("button",{type:"submit",disabled:c,className:"jsx-22d92177857556b4 save-btn",children:c?a?"Updating blog...":"Creating blog...":"Proceed"}),r&&(0,s.jsx)("button",{type:"button",onClick:r,disabled:c,style:c?{background:"#f0f0f0",color:"#aaa",cursor:"not-allowed"}:{},className:"jsx-22d92177857556b4 cancel-btn",children:"Cancel"})]}),(0,s.jsx)(l(),{id:"22d92177857556b4",children:".admin-form.jsx-22d92177857556b4{background:#fff;padding:2rem;border-radius:8px;box-shadow:0 2px 8px rgba(0,0,0,.04);margin-bottom:2rem}label.jsx-22d92177857556b4{display:block;font-weight:500;margin-bottom:.4rem}input.jsx-22d92177857556b4,textarea.jsx-22d92177857556b4{width:100%;padding:.6rem;border:1px solid#e0e0e0;border-radius:4px;margin-bottom:1rem;font-size:1rem}.form-actions.jsx-22d92177857556b4{display:flex;gap:1rem}.save-btn.jsx-22d92177857556b4{background:#4f8cff;color:#fff;border:none;padding:.7rem 2rem;border-radius:4px;font-weight:600;cursor:pointer}.save-btn[disabled].jsx-22d92177857556b4{background:#b3d1ff!important;color:#fff!important;cursor:not-allowed!important}.cancel-btn.jsx-22d92177857556b4{background:#eee;color:#222;border:none;padding:.7rem 2rem;border-radius:4px;font-weight:600;cursor:pointer}.cancel-btn[disabled].jsx-22d92177857556b4{background:#f0f0f0!important;color:#aaa!important;cursor:not-allowed!important}.err.jsx-22d92177857556b4{color:#ff4f4f;font-size:.95em}"})]})}var b=t(2871),f=t(4301);function m(){let[e,a]=(0,n.useState)([]),[t,r]=(0,n.useState)(null),[m,x]=(0,n.useState)(!1),[j,u]=(0,n.useState)(!0),[h,g]=(0,n.useState)(!1),[p,y]=(0,n.useState)("");(0,n.useEffect)(()=>{u(!0),(0,b.kz)().then(e=>{a(Array.isArray(e)?e:Array.isArray(null==e?void 0:e.data)?e.data:[]),y("")}).catch(()=>{y("Failed to fetch blogs. Please try again later."),a([])}).finally(()=>u(!1))},[]);let N=async t=>{if(confirm("Delete this blog?")){g(!0);try{await (0,b.cc)(t),a(e.filter(e=>e.id!==t)),f.oR.success("Blog deleted successfully!")}catch(e){f.oR.error("Failed to delete blog.")}finally{g(!1)}a(e.filter(e=>e.id!==t))}},w=async e=>{g(!0);try{if(t){await (0,b.c5)(t.id,e);let s=await (0,b.kz)();a(Array.isArray(s)?s:s.data||[]),f.oR.success("Blog updated successfully!")}else{let t=await (0,b.$5)(e);console.log(t);let s=await (0,b.kz)();a(Array.isArray(s)?s:s.data||[]),f.oR.success("Blog created successfully!")}x(!1),r(null)}catch(e){f.oR.error("Failed to save blog.")}finally{g(!1)}};return(0,s.jsx)(c.A,{children:(0,s.jsxs)("div",{className:"jsx-c7f1f2555910faf1 admin-layout",children:[(0,s.jsx)(i.A,{}),(0,s.jsxs)("main",{className:"jsx-c7f1f2555910faf1",children:[(0,s.jsx)(f.N9,{position:"top-right",autoClose:3e3}),(0,s.jsxs)("div",{className:"jsx-c7f1f2555910faf1 admin-header",children:[(0,s.jsx)("h1",{className:"jsx-c7f1f2555910faf1",children:"Blogs"}),!m&&(0,s.jsx)("button",{onClick:()=>{r(null),x(!0)},disabled:h,style:h?{opacity:.6,pointerEvents:"none"}:{},className:"jsx-c7f1f2555910faf1 add-btn",children:h&&!m?"Loading...":"+ Add Blog"})]}),m&&(0,s.jsx)(d,{initial:t,onSubmit:w,onCancel:()=>{x(!1),r(null)},loading:h}),p&&(0,s.jsx)("div",{style:{color:"#ff4f4f",marginBottom:"1rem",textAlign:"center"},className:"jsx-c7f1f2555910faf1",children:p}),(0,s.jsx)(o,{blogs:e,onEdit:e=>{r(e),x(!0)},onDelete:N,actionLoading:h}),j&&(0,s.jsx)("div",{style:{position:"absolute",left:0,top:0,width:"100%",height:"100%",background:"rgba(255,255,255,0.7)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:10},className:"jsx-c7f1f2555910faf1",children:(0,s.jsx)("div",{style:{fontSize:18},className:"jsx-c7f1f2555910faf1",children:"Loading..."})})]}),(0,s.jsx)(l(),{id:"c7f1f2555910faf1",children:".admin-layout.jsx-c7f1f2555910faf1{display:flex;min-height:100vh;background:#f5f7fb}main.jsx-c7f1f2555910faf1{flex:1;padding:2rem}.admin-header.jsx-c7f1f2555910faf1{display:flex;justify-content:space-between;align-items:center;margin-bottom:2rem}.add-btn.jsx-c7f1f2555910faf1{background:#4f8cff;color:#fff;border:none;padding:.7rem 2rem;border-radius:4px;font-weight:600;cursor:pointer;font-size:1rem}.add-btn[disabled].jsx-c7f1f2555910faf1{opacity:.6;cursor:not-allowed}@media(max-width:900px){main.jsx-c7f1f2555910faf1{padding:1rem;width:70%}}"})]})})}t(6689)}},e=>{e.O(0,[4938,9008,3835,1978,636,6593,8792],()=>e(e.s=3954)),_N_E=e.O()}]);