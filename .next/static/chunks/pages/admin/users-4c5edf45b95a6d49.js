(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4840],{1809:(e,a,s)=>{"use strict";s.r(a),s.d(a,{default:()=>h});var t=s(7876),r=s(1703),c=s.n(r),n=s(4232),i=s(2603),l=s(6427);function d(e){let{users:a,onEdit:s,onDelete:r}=e;return(0,t.jsxs)("div",{className:"jsx-ac461a408b00b81b table-responsive",children:[(0,t.jsxs)("table",{className:"jsx-ac461a408b00b81b admin-table",children:[(0,t.jsx)("thead",{className:"jsx-ac461a408b00b81b",children:(0,t.jsxs)("tr",{className:"jsx-ac461a408b00b81b",children:[(0,t.jsx)("th",{className:"jsx-ac461a408b00b81b",children:"First Name"}),(0,t.jsx)("th",{className:"jsx-ac461a408b00b81b",children:"Last Name"}),(0,t.jsx)("th",{className:"jsx-ac461a408b00b81b",children:"Email"}),(0,t.jsx)("th",{className:"jsx-ac461a408b00b81b",children:"Actions"})]})}),(0,t.jsxs)("tbody",{className:"jsx-ac461a408b00b81b",children:[0===a.length&&(0,t.jsx)("tr",{className:"jsx-ac461a408b00b81b",children:(0,t.jsx)("td",{colSpan:4,style:{textAlign:"center"},className:"jsx-ac461a408b00b81b",children:"No users found."})}),a.map(e=>(0,t.jsxs)("tr",{className:"jsx-ac461a408b00b81b",children:[(0,t.jsx)("td",{className:"jsx-ac461a408b00b81b",children:e.fName}),(0,t.jsx)("td",{className:"jsx-ac461a408b00b81b",children:e.lName}),(0,t.jsx)("td",{className:"jsx-ac461a408b00b81b",children:e.email}),(0,t.jsxs)("td",{className:"jsx-ac461a408b00b81b",children:[(0,t.jsx)("button",{onClick:()=>s(e),className:"jsx-ac461a408b00b81b edit-btn",children:"Edit"}),(0,t.jsx)("button",{onClick:()=>r(e.id),className:"jsx-ac461a408b00b81b delete-btn",children:"Delete"})]})]},e.id))]})]}),(0,t.jsx)(c(),{id:"ac461a408b00b81b",children:".table-responsive.jsx-ac461a408b00b81b{overflow-x:auto}.admin-table.jsx-ac461a408b00b81b{width:100%;border-collapse:collapse;background:#fff;margin-top:1rem}th.jsx-ac461a408b00b81b,td.jsx-ac461a408b00b81b{padding:.75rem 1rem;border-bottom:1px solid#eee}th.jsx-ac461a408b00b81b{background:#f7f8fa}.edit-btn.jsx-ac461a408b00b81b,.delete-btn.jsx-ac461a408b00b81b{margin-right:.5rem;padding:.4rem 1rem;border:none;border-radius:4px;font-size:.95rem;cursor:pointer}.edit-btn.jsx-ac461a408b00b81b{background:#4f8cff;color:#fff}.delete-btn.jsx-ac461a408b00b81b{background:#ff4f4f;color:#fff}@media(max-width:600px){th.jsx-ac461a408b00b81b,td.jsx-ac461a408b00b81b{padding:.5rem .3rem;font-size:.9rem}.edit-btn.jsx-ac461a408b00b81b,.delete-btn.jsx-ac461a408b00b81b{padding:.3rem .7rem;font-size:.85rem}}"})]})}function o(e){let{initial:a,onSubmit:s,onCancel:r,loading:i}=e,[l,d]=(0,n.useState)(a||{fName:"",lName:"",email:""}),[o,b]=(0,n.useState)({}),m=e=>{let{name:a,value:s}=e.target;d(e=>({...e,[a]:s}))};return(0,t.jsxs)("form",{onSubmit:e=>{e.preventDefault(),(()=>{let e={};return l.fName||(e.fName="First name is required"),l.lName||(e.lName="Last name is required"),l.email?/^[\w-.]+@([\w-]+\.)+[\w-]{2,4}$/.test(l.email)||(e.email="Invalid email"):e.email="Email is required",b(e),0===Object.keys(e).length})()&&s(l)},className:"jsx-887939cee963f8ac admin-form",children:[(0,t.jsxs)("div",{className:"jsx-887939cee963f8ac",children:[(0,t.jsx)("label",{className:"jsx-887939cee963f8ac",children:"First Name"}),(0,t.jsx)("input",{name:"fName",value:l.fName,onChange:m,required:!0,className:"jsx-887939cee963f8ac"}),o.fName&&(0,t.jsx)("span",{className:"jsx-887939cee963f8ac err",children:o.fName})]}),(0,t.jsxs)("div",{className:"jsx-887939cee963f8ac",children:[(0,t.jsx)("label",{className:"jsx-887939cee963f8ac",children:"Last Name"}),(0,t.jsx)("input",{name:"lName",value:l.lName,onChange:m,required:!0,className:"jsx-887939cee963f8ac"}),o.lName&&(0,t.jsx)("span",{className:"jsx-887939cee963f8ac err",children:o.lName})]}),(0,t.jsxs)("div",{className:"jsx-887939cee963f8ac",children:[(0,t.jsx)("label",{className:"jsx-887939cee963f8ac",children:"Email"}),(0,t.jsx)("input",{name:"email",value:l.email,onChange:m,required:!0,className:"jsx-887939cee963f8ac"}),o.email&&(0,t.jsx)("span",{className:"jsx-887939cee963f8ac err",children:o.email})]}),(0,t.jsxs)("div",{className:"jsx-887939cee963f8ac form-actions",children:[(0,t.jsx)("button",{type:"submit",disabled:i,className:"jsx-887939cee963f8ac save-btn",children:i?a?"Updating user...":"Creating user...":"Proceed"}),r&&(0,t.jsx)("button",{type:"button",onClick:r,disabled:i,style:i?{background:"#f0f0f0",color:"#aaa",cursor:"not-allowed"}:{},className:"jsx-887939cee963f8ac cancel-btn",children:"Cancel"})]}),(0,t.jsx)(c(),{id:"887939cee963f8ac",children:".admin-form.jsx-887939cee963f8ac{background:#fff;padding:2rem;border-radius:8px;box-shadow:0 2px 8px rgba(0,0,0,.04);margin-bottom:2rem}label.jsx-887939cee963f8ac{display:block;font-weight:500;margin-bottom:.4rem}input.jsx-887939cee963f8ac{width:100%;padding:.6rem;border:1px solid#e0e0e0;border-radius:4px;margin-bottom:1rem;font-size:1rem}.form-actions.jsx-887939cee963f8ac{display:flex;gap:1rem}.save-btn.jsx-887939cee963f8ac{background:#4f8cff;color:#fff;border:none;padding:.7rem 2rem;border-radius:4px;font-weight:600;cursor:pointer}.save-btn[disabled].jsx-887939cee963f8ac{background:#b3d1ff!important;color:#fff!important;cursor:not-allowed!important}.cancel-btn.jsx-887939cee963f8ac{background:#eee;color:#222;border:none;padding:.7rem 2rem;border-radius:4px;font-weight:600;cursor:pointer}.cancel-btn[disabled].jsx-887939cee963f8ac{background:#f0f0f0!important;color:#aaa!important;cursor:not-allowed!important}.err.jsx-887939cee963f8ac{color:#ff4f4f;font-size:.95em}"})]})}function b(){return sessionStorage.getItem("admin_token")}async function m(){let e=b(),a=await fetch("".concat("https://live.maypascollege.com","/api/v1/admin/users/all"),{headers:{Authorization:"Bearer ".concat(e)}});if(!a.ok)throw Error("Failed to fetch users");let s=await a.json();return Array.isArray(s)?s:s.data||[]}async function f(e){let a=b(),s=new FormData;Object.entries(e).forEach(e=>{let[a,t]=e;s.append(a,t)});let t=await fetch("".concat("https://live.maypascollege.com","/api/v1/admin/user/create"),{method:"POST",headers:{Authorization:"Bearer ".concat(a)},body:s});if(!t.ok)throw Error("Failed to create user");return t.json()}async function x(e,a){let s=b(),t=new FormData;Object.entries(a).forEach(e=>{let[a,s]=e;t.append(a,s)});let r=await fetch("".concat("https://live.maypascollege.com","/api/v1/admin/user/update/").concat(e),{method:"POST",headers:{Authorization:"Bearer ".concat(s)},body:t});if(!r.ok)throw Error("Failed to update user");return r.json()}async function u(e){let a=b(),s=await fetch("".concat("https://live.maypascollege.com","/api/v1/admin/user/delete/").concat(e),{method:"DELETE",headers:{Authorization:"Bearer ".concat(a),"Content-Type":"application/json"}});if(!s.ok)throw Error("Failed to delete user");return s.json()}var j=s(4301);function h(){let[e,a]=(0,n.useState)([]),[s,r]=(0,n.useState)(null),[b,h]=(0,n.useState)(!1),[p,N]=(0,n.useState)(!0),[g,y]=(0,n.useState)(!1),[w,v]=(0,n.useState)("");(0,n.useEffect)(()=>{N(!0),m().then(e=>{a(Array.isArray(e)?e:Array.isArray(null==e?void 0:e.data)?e.data:[]),v("")}).catch(()=>{v("Failed to fetch users. Please try again later."),a([])}).finally(()=>N(!1))},[]);let k=async s=>{if(confirm("Delete this user?")){y(!0);try{await u(s),a(e.filter(e=>e.id!==s)),j.oR.success("User deleted successfully!")}catch(e){j.oR.error("Failed to delete user.")}finally{y(!1)}a(e.filter(e=>e.id!==s))}},E=async e=>{y(!0);try{if(s){await x(s.id,e);let t=await m();a(Array.isArray(t)?t:t.data||[]),j.oR.success("User updated successfully!")}else{await f(e);let s=await m();a(Array.isArray(s)?s:s.data||[]),j.oR.success("User created successfully!")}h(!1),r(null)}catch(a){var t,c,n,i;let e="Failed to create or update user.";(null==(c=a.response)||null==(t=c.data)?void 0:t.errors)?e=Object.values(a.response.data.errors).flat().join("\n"):(null==(i=a.response)||null==(n=i.data)?void 0:n.message)&&(e=a.response.data.message),j.oR.error(e)}finally{y(!1)}};return(0,t.jsx)(i.A,{children:(0,t.jsxs)("div",{className:"jsx-16cc2ba9941bd316 admin-layout",children:[(0,t.jsx)(l.A,{}),(0,t.jsxs)("main",{className:"jsx-16cc2ba9941bd316",children:[(0,t.jsx)(j.N9,{position:"top-right",autoClose:3e3}),(0,t.jsxs)("div",{className:"jsx-16cc2ba9941bd316 admin-header",children:[(0,t.jsx)("h1",{className:"jsx-16cc2ba9941bd316",children:"Users"}),!b&&(0,t.jsx)("button",{onClick:()=>{r(null),h(!0)},disabled:g,style:g?{opacity:.6,pointerEvents:"none"}:{},className:"jsx-16cc2ba9941bd316 add-btn",children:g&&!b?"Loading...":"+ Add User"})]}),b&&(0,t.jsx)(o,{initial:s,onSubmit:E,onCancel:()=>{h(!1),r(null)},loading:g}),w&&(0,t.jsx)("div",{style:{color:"#ff4f4f",marginBottom:"1rem",textAlign:"center"},className:"jsx-16cc2ba9941bd316",children:w}),(0,t.jsx)(d,{users:e,onEdit:e=>{r(e),h(!0)},onDelete:k,actionLoading:g}),p&&(0,t.jsx)("div",{style:{position:"absolute",left:0,top:0,width:"100%",height:"100%",background:"rgba(255,255,255,0.7)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:10},className:"jsx-16cc2ba9941bd316",children:(0,t.jsx)("div",{style:{fontSize:18},className:"jsx-16cc2ba9941bd316",children:"Loading..."})})]}),(0,t.jsx)(c(),{id:"16cc2ba9941bd316",children:".admin-layout.jsx-16cc2ba9941bd316{display:flex;min-height:100vh;background:#f5f7fb}main.jsx-16cc2ba9941bd316{flex:1;padding:2rem}.admin-header.jsx-16cc2ba9941bd316{display:flex;justify-content:space-between;align-items:center;margin-bottom:2rem}.add-btn.jsx-16cc2ba9941bd316{background:#4f8cff;color:#fff;border:none;padding:.7rem 2rem;border-radius:4px;font-weight:600;cursor:pointer;font-size:1rem}@media(max-width:700px){main.jsx-16cc2ba9941bd316{padding:1rem;width:70%}}"})]})})}s(6689)},2562:(e,a,s)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/admin/users",function(){return s(1809)}])},6689:()=>{}},e=>{e.O(0,[4938,9008,3835,1978,636,6593,8792],()=>e(e.s=2562)),_N_E=e.O()}]);