(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9470],{2874:(e,a,t)=>{"use strict";t.r(a),t.d(a,{default:()=>m});var s=t(7876),r=t(1703),c=t.n(r),o=t(4232),i=t(6427);function n(e){let{courses:a,onEdit:t,onDelete:r}=e;return(0,s.jsxs)("div",{className:"jsx-ac461a408b00b81b table-responsive",children:[(0,s.jsxs)("table",{className:"jsx-ac461a408b00b81b admin-table",children:[(0,s.jsx)("thead",{className:"jsx-ac461a408b00b81b",children:(0,s.jsxs)("tr",{className:"jsx-ac461a408b00b81b",children:[(0,s.jsx)("th",{className:"jsx-ac461a408b00b81b",children:"Image"}),(0,s.jsx)("th",{className:"jsx-ac461a408b00b81b",children:"Course Category"}),(0,s.jsx)("th",{className:"jsx-ac461a408b00b81b",children:"Title"}),(0,s.jsx)("th",{className:"jsx-ac461a408b00b81b",children:"Excerpt"}),(0,s.jsx)("th",{className:"jsx-ac461a408b00b81b",children:"Price"}),(0,s.jsx)("th",{className:"jsx-ac461a408b00b81b",children:"Actions"})]})}),(0,s.jsxs)("tbody",{className:"jsx-ac461a408b00b81b",children:[0===a.length&&(0,s.jsx)("tr",{className:"jsx-ac461a408b00b81b",children:(0,s.jsx)("td",{colSpan:6,style:{textAlign:"center"},className:"jsx-ac461a408b00b81b",children:"No courses found."})}),a.map(e=>{var a;return(0,s.jsxs)("tr",{className:"jsx-ac461a408b00b81b",children:[(0,s.jsx)("td",{className:"jsx-ac461a408b00b81b",children:e.featured_image_path?(0,s.jsx)("img",{src:"https://live.maypascollege.com/storage/"+e.featured_image_path,alt:"",style:{width:60,borderRadius:6},className:"jsx-ac461a408b00b81b"}):(0,s.jsx)("span",{style:{color:"#000"},className:"jsx-ac461a408b00b81b",children:"No image"})}),(0,s.jsx)("td",{className:"jsx-ac461a408b00b81b",children:(null==(a=e.category)?void 0:a.name)||"No category"}),(0,s.jsx)("td",{className:"jsx-ac461a408b00b81b",children:e.title}),(0,s.jsx)("td",{className:"jsx-ac461a408b00b81b",children:e.excerpt}),(0,s.jsxs)("td",{className:"jsx-ac461a408b00b81b",children:["$",e.price]}),(0,s.jsxs)("td",{className:"jsx-ac461a408b00b81b",children:[(0,s.jsx)("button",{onClick:()=>t(e),className:"jsx-ac461a408b00b81b edit-btn",children:"Edit"}),(0,s.jsx)("button",{onClick:()=>r(e.id),className:"jsx-ac461a408b00b81b delete-btn",children:"Delete"})]})]},e.id)})]})]}),(0,s.jsx)(c(),{id:"ac461a408b00b81b",children:".table-responsive.jsx-ac461a408b00b81b{overflow-x:auto}.admin-table.jsx-ac461a408b00b81b{width:100%;border-collapse:collapse;background:#fff;margin-top:1rem}th.jsx-ac461a408b00b81b,td.jsx-ac461a408b00b81b{padding:.75rem 1rem;border-bottom:1px solid#eee}th.jsx-ac461a408b00b81b{background:#f7f8fa}.edit-btn.jsx-ac461a408b00b81b,.delete-btn.jsx-ac461a408b00b81b{margin-right:.5rem;padding:.4rem 1rem;border:none;border-radius:4px;font-size:.95rem;cursor:pointer}.edit-btn.jsx-ac461a408b00b81b{background:#4f8cff;color:#fff}.delete-btn.jsx-ac461a408b00b81b{background:#ff4f4f;color:#fff}@media(max-width:600px){th.jsx-ac461a408b00b81b,td.jsx-ac461a408b00b81b{padding:.5rem .3rem;font-size:.9rem}.edit-btn.jsx-ac461a408b00b81b,.delete-btn.jsx-ac461a408b00b81b{padding:.3rem .7rem;font-size:.85rem}}"})]})}function l(e){let{initial:a={},categories:t=[],onCancel:r,loading:i,onSubmit:n}=e,l=a||{},[d,b]=(0,o.useState)({course_category_id:l.course_category_id||"",title:l.title||"",excerpt:l.excerpt||"",description:l.description||"",price:l.price||"",featured_image:l.featured_image||null}),[f,u]=(0,o.useState)({}),[m,p]=(0,o.useState)((null==l?void 0:l.featured_image_path)?(null==l?void 0:l.featured_image_path.startsWith("http"))?l.featured_image_path:"https://live.maypascollege.com/storage/"+l.featured_image_path:""),x=(0,o.useRef)(),[j,h]=(0,o.useState)(l.course_info_name&&l.course_info_value?l.course_info_name.map((e,a)=>({name:e,value:l.course_info_value[a]||""})):[{name:"",value:""}]),g=e=>{let{name:a,value:t,files:s}=e.target;"featured_image"===a?b(e=>({...e,featured_image:s[0]})):b(e=>({...e,[a]:t}))},y=(e,a,t)=>{h(s=>s.map((s,r)=>r===e?{...s,[a]:t}:s))};return(0,s.jsxs)("form",{onSubmit:e=>{e.preventDefault();let a={...d,"course_info_name[]":j.map(e=>e.name),"course_info_value[]":j.map(e=>e.value)};(()=>{let e={};return d.course_category_id||(e.course_category_id="Category is required"),d.title||(e.title="Title is required"),d.excerpt||(e.excerpt="Excerpt is required"),d.description||(e.description="Description is required"),d.price||(e.price="Price is required"),u(e),0===Object.keys(e).length})()&&n(a)},encType:"multipart/form-data",className:"jsx-eae381936f0fbcd0 admin-form",children:[(0,s.jsxs)("div",{className:"jsx-eae381936f0fbcd0 form-group",children:[(0,s.jsx)("label",{className:"jsx-eae381936f0fbcd0",children:"Category"}),(0,s.jsxs)("select",{name:"course_category_id",value:d.course_category_id,onChange:g,required:!0,className:"jsx-eae381936f0fbcd0",children:[(0,s.jsx)("option",{value:"",className:"jsx-eae381936f0fbcd0",children:"Select Category"}),t.map(e=>(0,s.jsx)("option",{value:e.id,className:"jsx-eae381936f0fbcd0",children:e.name},e.id))]})]}),(0,s.jsxs)("div",{className:"jsx-eae381936f0fbcd0 form-group",children:[(0,s.jsx)("label",{className:"jsx-eae381936f0fbcd0",children:"Title"}),(0,s.jsx)("input",{name:"title",value:d.title,onChange:g,required:!0,className:"jsx-eae381936f0fbcd0"})]}),(0,s.jsxs)("div",{className:"jsx-eae381936f0fbcd0 form-group",children:[(0,s.jsx)("label",{className:"jsx-eae381936f0fbcd0",children:"Excerpt"}),(0,s.jsx)("input",{name:"excerpt",value:d.excerpt,onChange:g,className:"jsx-eae381936f0fbcd0"})]}),(0,s.jsxs)("div",{className:"jsx-eae381936f0fbcd0 form-group",children:[(0,s.jsx)("label",{className:"jsx-eae381936f0fbcd0",children:"Description"}),(0,s.jsx)("textarea",{name:"description",value:d.description,onChange:g,required:!0,className:"jsx-eae381936f0fbcd0"})]}),(0,s.jsxs)("div",{className:"jsx-eae381936f0fbcd0 form-group",children:[(0,s.jsx)("label",{className:"jsx-eae381936f0fbcd0",children:"Price"}),(0,s.jsx)("input",{name:"price",type:"number",value:d.price,onChange:g,required:!0,className:"jsx-eae381936f0fbcd0"})]}),(0,s.jsxs)("div",{className:"jsx-eae381936f0fbcd0 form-group",children:[(0,s.jsx)("label",{className:"jsx-eae381936f0fbcd0",children:"Featured Image"}),(0,s.jsx)("input",{type:"file",accept:"image/*",ref:x,onChange:e=>{let a=e.target.files[0];a&&a.type.startsWith("image/")?(b(e=>({...e,featured_image:a})),p(URL.createObjectURL(a))):u(e=>({...e,featured_image:"Only image files allowed"}))},className:"jsx-eae381936f0fbcd0"}),m&&(0,s.jsx)("img",{src:m,alt:"preview",style:{width:100,marginTop:8,borderRadius:6},className:"jsx-eae381936f0fbcd0"}),f.featured_image_path&&(0,s.jsx)("span",{className:"jsx-eae381936f0fbcd0 err",children:f.featured_image_path})]}),(0,s.jsxs)("div",{className:"jsx-eae381936f0fbcd0 form-group",children:[(0,s.jsx)("label",{className:"jsx-eae381936f0fbcd0",children:"Course Info"}),j.map((e,a)=>(0,s.jsxs)("div",{style:{display:"flex",gap:8,marginBottom:8},className:"jsx-eae381936f0fbcd0",children:[(0,s.jsx)("input",{type:"text",placeholder:"Info Name",value:e.name,onChange:e=>y(a,"name",e.target.value),required:!0,style:{flex:1},className:"jsx-eae381936f0fbcd0"}),(0,s.jsx)("input",{type:"text",placeholder:"Info Value",value:e.value,onChange:e=>y(a,"value",e.target.value),required:!0,style:{flex:2},className:"jsx-eae381936f0fbcd0"}),(0,s.jsx)("button",{type:"button",onClick:()=>{h(e=>e.filter((e,t)=>t!==a))},disabled:1===j.length,style:{background:"#ff4f4f",color:"#fff",border:"none",borderRadius:4,padding:"0 10px",cursor:"pointer"},title:"Remove",className:"jsx-eae381936f0fbcd0",children:"\xd7"})]},a)),(0,s.jsx)("button",{type:"button",onClick:()=>{h(e=>[...e,{name:"",value:""}])},style:{background:"#4f8cff",color:"#fff",border:"none",borderRadius:4,padding:"0.3rem 1rem",marginTop:4,cursor:"pointer"},className:"jsx-eae381936f0fbcd0",children:"+ Add Another"})]}),(0,s.jsxs)("div",{style:{marginTop:24,display:"flex",gap:12},className:"jsx-eae381936f0fbcd0",children:[(0,s.jsx)("button",{type:"submit",disabled:i,className:"jsx-eae381936f0fbcd0 btn",children:i?"Saving...":"Save"}),(0,s.jsx)("button",{type:"button",onClick:r,disabled:i,className:"jsx-eae381936f0fbcd0 btn btn-border",children:"Cancel"})]}),(0,s.jsx)(c(),{id:"eae381936f0fbcd0",children:".admin-form.jsx-eae381936f0fbcd0{background:#fff;padding:2rem;border-radius:8px;max-width:600px;margin:0 auto 2rem auto;box-shadow:0 2px 16px rgba(0,0,0,.04)}.form-group.jsx-eae381936f0fbcd0{margin-bottom:1.2rem}.form-group.jsx-eae381936f0fbcd0 label.jsx-eae381936f0fbcd0{font-weight:600;margin-bottom:.3rem;display:block}.form-group.jsx-eae381936f0fbcd0 input.jsx-eae381936f0fbcd0,.form-group.jsx-eae381936f0fbcd0 select.jsx-eae381936f0fbcd0,.form-group.jsx-eae381936f0fbcd0 textarea.jsx-eae381936f0fbcd0{width:100%;padding:.5rem;border-radius:4px;border:1px solid#ddd}.btn.jsx-eae381936f0fbcd0{background:#4f8cff;color:#fff;border:none;padding:.7rem 2rem;border-radius:4px;font-weight:600;cursor:pointer;font-size:1rem}.btn.btn-border.jsx-eae381936f0fbcd0{background:#fff;color:#4f8cff;border:1px solid#4f8cff}.btn[disabled].jsx-eae381936f0fbcd0{opacity:.6;cursor:not-allowed}"})]})}var d=t(5360),b=t(8760),f=t(2603),u=t(4301);function m(){let[e,a]=(0,o.useState)([]),[t,r]=(0,o.useState)([]),[m,p]=(0,o.useState)(null),[x,j]=(0,o.useState)(!1),[h,g]=(0,o.useState)(!0),[y,_]=(0,o.useState)(!1),[v,N]=(0,o.useState)("");(0,o.useEffect)(()=>{(0,d.bW)().then(e=>{r(Array.isArray(e)?e:e.data||[])}).catch(()=>r([]))},[]),(0,o.useEffect)(()=>{g(!0),(0,b.D)().then(e=>{a(Array.isArray(e)?e:Array.isArray(null==e?void 0:e.data)?e.data:[]),N("")}).catch(()=>{N("Failed to fetch courses. Please try again later."),a([])}).finally(()=>g(!1))},[]);let w=async t=>{if(confirm("Delete this course?")){_(!0);try{await (0,b.zs)(t);let e=await (0,b.D)();a(Array.isArray(e)?e:e.data||[])}catch(t){u.oR.error("Failed to delete course.");let e=await (0,b.D)();a(Array.isArray(e)?e:e.data||[])}finally{_(!1)}a(e.filter(e=>e.id!==t))}},A=async e=>{_(!0);try{if(m){await (0,b.J4)(m.id,e);let t=await (0,b.D)();a(Array.isArray(t)?t:t.data||[]),u.oR.success("Course updated successfully!")}else{await (0,b.C_)(e);let t=await (0,b.D)();a(Array.isArray(t)?t:t.data||[]),u.oR.success("Course created successfully!")}j(!1),p(null)}catch(e){u.oR.error("Failed to save course.")}finally{_(!1)}};return(0,s.jsx)(f.A,{children:(0,s.jsxs)("div",{className:"jsx-4c6b1770cbc1dbbf admin-layout",children:[(0,s.jsx)(i.A,{}),(0,s.jsxs)("main",{className:"jsx-4c6b1770cbc1dbbf",children:[(0,s.jsx)(u.N9,{position:"top-right",autoClose:3e3}),(0,s.jsxs)("div",{className:"jsx-4c6b1770cbc1dbbf admin-header",children:[(0,s.jsx)("h1",{className:"jsx-4c6b1770cbc1dbbf",children:"Courses"}),!x&&(0,s.jsx)("button",{onClick:()=>{p(null),j(!0)},disabled:y,style:y?{opacity:.6,pointerEvents:"none"}:{},className:"jsx-4c6b1770cbc1dbbf add-btn",children:y&&!x?"Loading...":"+ Add Course"})]}),x&&(0,s.jsx)(l,{initial:m,categories:t,onCancel:()=>{j(!1),p(null)},loading:y,onSubmit:A}),v&&(0,s.jsx)("div",{style:{color:"#ff4f4f",marginBottom:"1rem",textAlign:"center"},className:"jsx-4c6b1770cbc1dbbf",children:v}),(0,s.jsx)(n,{courses:e,onEdit:e=>{p(e),j(!0)},onDelete:w,actionLoading:y}),h&&(0,s.jsx)("div",{style:{position:"absolute",left:0,top:0,width:"100%",height:"100%",background:"rgba(255,255,255,0.7)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:10},className:"jsx-4c6b1770cbc1dbbf",children:(0,s.jsx)("div",{style:{fontSize:18},className:"jsx-4c6b1770cbc1dbbf",children:"Loading..."})})]}),(0,s.jsx)(c(),{id:"4c6b1770cbc1dbbf",children:".admin-layout.jsx-4c6b1770cbc1dbbf{display:flex;min-height:100vh;background:#f5f7fb}main.jsx-4c6b1770cbc1dbbf{flex:1;padding:2rem}.admin-header.jsx-4c6b1770cbc1dbbf{display:flex;justify-content:space-between;align-items:center;margin-bottom:2rem}.add-btn.jsx-4c6b1770cbc1dbbf{background:#4f8cff;color:#fff;border:none;padding:.7rem 2rem;border-radius:4px;font-weight:600;cursor:pointer;font-size:1rem}.add-btn[disabled].jsx-4c6b1770cbc1dbbf{opacity:.6;cursor:not-allowed}@media(max-width:900px){main.jsx-4c6b1770cbc1dbbf{padding:1rem;width:70%}}"})]})})}t(6689)},5360:(e,a,t)=>{"use strict";function s(){{let e=sessionStorage.getItem("admin_token");return console.log(e),e}}async function r(e){let a=s(),t=new FormData;Object.entries(e).forEach(e=>{let[a,s]=e;t.append(a,s)});let r=await fetch("".concat("https://live.maypascollege.com","/api/v1/contents/category/create"),{method:"POST",headers:{Authorization:"Bearer ".concat(a),Accept:"application/json"},body:t});if(console.log(r),!r.ok)throw Error("Failed to create category");return r.json()}async function c(){let e=s(),a=await fetch("".concat("https://live.maypascollege.com","/api/v1/course/categories"),{headers:{Authorization:"Bearer ".concat(e)}});if(!a.ok)throw Error("Failed to fetch categories");return a.json()}async function o(e,a){let t=s(),r=new FormData;Object.entries(a).forEach(e=>{let[a,t]=e;r.append(a,t)});let c=await fetch("".concat("https://live.maypascollege.com","/api/v1/contents/category/update/").concat(e),{method:"POST",headers:{Authorization:"Bearer ".concat(t),Accept:"application/json"},body:r});if(!c.ok)throw Error("Failed to update category");return c.json()}async function i(e){let a=s(),t=await fetch("".concat("https://live.maypascollege.com","/api/v1/contents/category/delete/").concat(e),{method:"POST",headers:{Authorization:"Bearer ".concat(a),"Content-Type":"application/json"}});if(!t.ok)throw Error("Failed to delete category");return t.json()}t.d(a,{K7:()=>i,bW:()=>c,st:()=>o,zZ:()=>r})},6689:()=>{},8760:(e,a,t)=>{"use strict";function s(){return sessionStorage.getItem("admin_token")}async function r(){let e=s(),a=await fetch("".concat("https://live.maypascollege.com","/api/v1/courses/get"),{headers:{Authorization:"Bearer ".concat(e)}});if(!a.ok)throw Error("Failed to fetch courses list");let t=await a.json();return Array.isArray(t)?t:t.data||[]}async function c(e){let a=s(),t=new FormData;for(let a of(Object.entries(e).forEach(e=>{let[a,s]=e;"course_info_name[]"===a&&Array.isArray(s)?s.forEach(e=>t.append("course_info_name[]",e)):"course_info_value[]"===a&&Array.isArray(s)?s.forEach(e=>t.append("course_info_value[]",e)):"featured_image"===a&&s?s instanceof File?t.append("featured_image",s):Array.isArray(s)&&s.forEach(e=>t.append("featured_image",e)):t.append(a,s)}),t.entries()))console.log("FormData:",a[0],":",a[1]);console.log(e),console.log("Creating course with FormData:");let r=await fetch("".concat("https://live.maypascollege.com","/api/v1/contents/course/create"),{method:"POST",headers:{Authorization:"Bearer ".concat(a),Accept:"application/json"},body:t});if(console.log(r),!r.ok)throw Error("Failed to create course");return r.json()}async function o(e,a){let t=s(),r=new FormData;for(let e of(Object.entries(a).forEach(e=>{let[a,t]=e;"course_info_name[]"===a&&Array.isArray(t)?t.forEach(e=>r.append("course_info_name[]",e)):"course_info_value[]"===a&&Array.isArray(t)?t.forEach(e=>r.append("course_info_value[]",e)):"featured_image"===a&&t?t instanceof File?r.append("featured_image",t):Array.isArray(t)&&t.forEach(e=>r.append("featured_image",e)):r.append(a,t)}),r.entries()))console.log("FormData:",e[0],":",e[1]);let c=await fetch("".concat("https://live.maypascollege.com","/api/v1/contents/course/update/").concat(e),{method:"POST",headers:{Authorization:"Bearer ".concat(t),Accept:"application/json"},body:r});if(!c.ok)throw Error("Failed to update course");return c.json()}async function i(e){let a=s(),t=await fetch("".concat("https://live.maypascollege.com","/api/v1/contents/course/delete/").concat(e),{method:"POST",headers:{Authorization:"Bearer ".concat(a),"Content-Type":"application/json"}});if(!t.ok)throw Error("Failed to delete course");return t.json()}t.d(a,{C_:()=>c,D:()=>r,J4:()=>o,zs:()=>i})},9818:(e,a,t)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/admin/courses",function(){return t(2874)}])}},e=>{e.O(0,[4938,9008,3835,1978,636,6593,8792],()=>e(e.s=9818)),_N_E=e.O()}]);