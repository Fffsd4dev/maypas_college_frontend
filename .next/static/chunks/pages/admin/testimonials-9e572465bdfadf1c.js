(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3068],{314:(e,a,s)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/admin/testimonials",function(){return s(1098)}])},1098:(e,a,s)=>{"use strict";s.r(a),s.d(a,{default:()=>u});var t=s(7876),r=s(1703),n=s.n(r),o=s(4232),i=s(2603),c=s(6427);function d(e){let{testimonials:a,onEdit:s,onDelete:r}=e;return(0,t.jsxs)("div",{className:"jsx-ac461a408b00b81b table-responsive",children:[(0,t.jsxs)("table",{className:"jsx-ac461a408b00b81b admin-table",children:[(0,t.jsx)("thead",{className:"jsx-ac461a408b00b81b",children:(0,t.jsxs)("tr",{className:"jsx-ac461a408b00b81b",children:[(0,t.jsx)("th",{className:"jsx-ac461a408b00b81b",children:"Image"}),(0,t.jsx)("th",{className:"jsx-ac461a408b00b81b",children:"Student Name"}),(0,t.jsx)("th",{className:"jsx-ac461a408b00b81b",children:"Course"}),(0,t.jsx)("th",{className:"jsx-ac461a408b00b81b",children:"Rating"}),(0,t.jsx)("th",{className:"jsx-ac461a408b00b81b",children:"Content"}),(0,t.jsx)("th",{className:"jsx-ac461a408b00b81b",children:"Approval"}),(0,t.jsx)("th",{className:"jsx-ac461a408b00b81b",children:"Actions"})]})}),(0,t.jsxs)("tbody",{className:"jsx-ac461a408b00b81b",children:[0===a.length&&(0,t.jsx)("tr",{className:"jsx-ac461a408b00b81b",children:(0,t.jsx)("td",{colSpan:5,style:{textAlign:"center"},className:"jsx-ac461a408b00b81b",children:"No testimonials found."})}),a.map(e=>(0,t.jsxs)("tr",{className:"jsx-ac461a408b00b81b",children:[(0,t.jsx)("td",{className:"jsx-ac461a408b00b81b",children:e.student_photo?(0,t.jsx)("img",{src:"https://live.maypascollege.com/storage/"+e.student_photo,alt:"",style:{width:60,borderRadius:6},className:"jsx-ac461a408b00b81b"}):(0,t.jsx)("span",{style:{color:"#aaa"},className:"jsx-ac461a408b00b81b",children:"No image"})}),(0,t.jsx)("td",{className:"jsx-ac461a408b00b81b",children:e.student_name}),(0,t.jsx)("td",{className:"jsx-ac461a408b00b81b",children:e.course}),(0,t.jsx)("td",{className:"jsx-ac461a408b00b81b",children:[1,2,3,4,5].map(a=>(0,t.jsx)("i",{style:{color:a<=Number(e.rating)?"#FFD700":"#ccc",marginRight:2},className:"jsx-ac461a408b00b81b fas fa-star"},a))}),(0,t.jsx)("td",{style:{maxWidth:200,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},className:"jsx-ac461a408b00b81b",children:e.content}),(0,t.jsx)("td",{className:"jsx-ac461a408b00b81b",children:1==e.is_approved?"Approved":"Pending"}),(0,t.jsxs)("td",{className:"jsx-ac461a408b00b81b",children:[(0,t.jsx)("button",{onClick:()=>s(e),className:"jsx-ac461a408b00b81b edit-btn",children:"Edit"}),(0,t.jsx)("button",{onClick:()=>r(e.id),className:"jsx-ac461a408b00b81b delete-btn",children:"Delete"})]})]},e.id))]})]}),(0,t.jsx)(n(),{id:"ac461a408b00b81b",children:".table-responsive.jsx-ac461a408b00b81b{overflow-x:auto}.admin-table.jsx-ac461a408b00b81b{width:100%;border-collapse:collapse;background:#fff;margin-top:1rem}th.jsx-ac461a408b00b81b,td.jsx-ac461a408b00b81b{padding:.75rem 1rem;border-bottom:1px solid#eee}th.jsx-ac461a408b00b81b{background:#f7f8fa}.edit-btn.jsx-ac461a408b00b81b,.delete-btn.jsx-ac461a408b00b81b{margin-right:.5rem;padding:.4rem 1rem;border:none;border-radius:4px;font-size:.95rem;cursor:pointer}.edit-btn.jsx-ac461a408b00b81b{background:#4f8cff;color:#fff}.delete-btn.jsx-ac461a408b00b81b{background:#ff4f4f;color:#fff}@media(max-width:600px){th.jsx-ac461a408b00b81b,td.jsx-ac461a408b00b81b{padding:.5rem .3rem;font-size:.9rem}.edit-btn.jsx-ac461a408b00b81b,.delete-btn.jsx-ac461a408b00b81b{padding:.3rem .7rem;font-size:.85rem}}"})]})}var l=s(8760);function m(e){let{initial:a,onSubmit:s,onCancel:r,loading:i}=e,[c,d]=(0,o.useState)(a||{student_name:"",course_id:"",content:"",rating:"",student_photo:null,is_approved:"0"});(0,o.useEffect)(()=>{a&&d(a)},[a]);let[m,b]=(0,o.useState)({}),[f,u]=(0,o.useState)((null==a?void 0:a.student_photo)?a.student_photo.startsWith("http")?a.student_photo:"https://live.maypascollege.com/storage/"+a.student_photo:""),x=(0,o.useRef)(),[h,j]=(0,o.useState)([]);(0,o.useEffect)(()=>{(0,l.D)().then(e=>{j(Array.isArray(e)?e:Array.isArray(null==e?void 0:e.data)?e.data:[])}).catch(()=>j([]))},[]);let p=e=>{let{name:a,value:s}=e.target;d(e=>({...e,[a]:s}))};return(0,t.jsxs)("form",{onSubmit:e=>{e.preventDefault(),(()=>{let e={};return c.student_name||(e.student_name="Student name is required"),c.course_id||(e.course_id="Course is required"),c.content||(e.content="Content is required"),c.rating&&[1,2,3,4,5].includes(Number(c.rating))||(e.rating="Rating must be 1-5"),"1"!==c.is_approved&&"0"!==c.is_approved&&(e.is_approved="Approval is required"),b(e),0===Object.keys(e).length})()&&s(c)},className:"jsx-843f2aed1d571725 admin-form",children:[(0,t.jsxs)("div",{className:"jsx-843f2aed1d571725",children:[(0,t.jsx)("label",{className:"jsx-843f2aed1d571725",children:"Student Photo"}),f&&(0,t.jsx)("img",{src:f,alt:"preview",style:{width:100,marginTop:8,borderRadius:6},className:"jsx-843f2aed1d571725"}),(0,t.jsx)("input",{type:"file",accept:"image/*",ref:x,onChange:e=>{let a=e.target.files[0];a&&a.type.startsWith("image/")?(d(e=>({...e,student_photo:a})),u(URL.createObjectURL(a))):a&&b(e=>({...e,student_photo:"Only image files allowed"}))},className:"jsx-843f2aed1d571725"}),m.student_photo&&(0,t.jsx)("span",{className:"jsx-843f2aed1d571725 err",children:m.student_photo})]}),(0,t.jsxs)("div",{className:"jsx-843f2aed1d571725",children:[(0,t.jsx)("label",{className:"jsx-843f2aed1d571725",children:"Student Name"}),(0,t.jsx)("input",{name:"student_name",value:c.student_name,onChange:p,required:!0,className:"jsx-843f2aed1d571725"}),m.student_name&&(0,t.jsx)("span",{className:"jsx-843f2aed1d571725 err",children:m.student_name})]}),(0,t.jsxs)("div",{className:"jsx-843f2aed1d571725",children:[(0,t.jsx)("label",{className:"jsx-843f2aed1d571725",children:"Course"}),(0,t.jsxs)("select",{name:"course_id",value:c.course_id,onChange:p,required:!0,className:"jsx-843f2aed1d571725",children:[(0,t.jsx)("option",{value:"",className:"jsx-843f2aed1d571725",children:"Select Course"}),h.map(e=>(0,t.jsx)("option",{value:e.id,className:"jsx-843f2aed1d571725",children:e.title},e.id))]}),m.course_id&&(0,t.jsx)("span",{className:"jsx-843f2aed1d571725 err",children:m.course_id})]}),(0,t.jsxs)("div",{className:"jsx-843f2aed1d571725",children:[(0,t.jsx)("label",{className:"jsx-843f2aed1d571725",children:"Content"}),(0,t.jsx)("textarea",{name:"content",value:c.content,onChange:p,rows:3,required:!0,className:"jsx-843f2aed1d571725"}),m.content&&(0,t.jsx)("span",{className:"jsx-843f2aed1d571725 err",children:m.content})]}),(0,t.jsxs)("div",{className:"jsx-843f2aed1d571725",children:[(0,t.jsx)("label",{className:"jsx-843f2aed1d571725",children:"Approve"}),(0,t.jsxs)("select",{name:"is_approved",value:c.is_approved,onChange:p,required:!0,className:"jsx-843f2aed1d571725",children:[(0,t.jsx)("option",{value:"1",className:"jsx-843f2aed1d571725",children:"Yes"}),(0,t.jsx)("option",{value:"0",className:"jsx-843f2aed1d571725",children:"No"})]}),m.is_approved&&(0,t.jsx)("span",{className:"jsx-843f2aed1d571725 err",children:m.is_approved})]}),(0,t.jsxs)("div",{className:"jsx-843f2aed1d571725",children:[(0,t.jsx)("label",{className:"jsx-843f2aed1d571725",children:"Rating"}),(0,t.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:4,marginBottom:8},className:"jsx-843f2aed1d571725",children:[[1,2,3,4,5].map(e=>(0,t.jsx)("i",{style:{color:e<=Number(c.rating)?"#FFD700":"#ccc",fontSize:"1.5em",cursor:"pointer",transition:"color 0.2s"},onClick:()=>{d(a=>({...a,rating:String(e)})),b(e=>({...e,rating:void 0}))},"aria-label":"Rate ".concat(e," star").concat(e>1?"s":""),className:"jsx-843f2aed1d571725 fas fa-star"},e)),(0,t.jsx)("span",{style:{marginLeft:8,fontWeight:500},className:"jsx-843f2aed1d571725",children:c.rating?"".concat(c.rating," / 5"):""})]}),m.rating&&(0,t.jsx)("span",{className:"jsx-843f2aed1d571725 err",children:m.rating})]}),(0,t.jsxs)("div",{className:"jsx-843f2aed1d571725 form-actions",children:[(0,t.jsx)("button",{type:"submit",disabled:i,className:"jsx-843f2aed1d571725 save-btn",children:i?a?"Updating testimonial...":"Creating testimonial...":"Proceed"}),r&&(0,t.jsx)("button",{type:"button",onClick:r,disabled:i,style:i?{background:"#f0f0f0",color:"#aaa",cursor:"not-allowed"}:{},className:"jsx-843f2aed1d571725 cancel-btn",children:"Cancel"})]}),(0,t.jsx)(n(),{id:"843f2aed1d571725",children:".admin-form.jsx-843f2aed1d571725{background:#fff;padding:2rem;border-radius:8px;box-shadow:0 2px 8px rgba(0,0,0,.04);margin-bottom:2rem}label.jsx-843f2aed1d571725{display:block;font-weight:500;margin-bottom:.4rem}input.jsx-843f2aed1d571725,textarea.jsx-843f2aed1d571725,select.jsx-843f2aed1d571725{width:100%;padding:.6rem;border:1px solid#e0e0e0;border-radius:4px;margin-bottom:1rem;font-size:1rem}.form-actions.jsx-843f2aed1d571725{display:flex;gap:1rem}.save-btn.jsx-843f2aed1d571725{background:#4f8cff;color:#fff;border:none;padding:.7rem 2rem;border-radius:4px;font-weight:600;cursor:pointer}.save-btn[disabled].jsx-843f2aed1d571725{background:#b3d1ff!important;color:#fff!important;cursor:not-allowed!important}.cancel-btn.jsx-843f2aed1d571725{background:#eee;color:#222;border:none;padding:.7rem 2rem;border-radius:4px;font-weight:600;cursor:pointer}.cancel-btn[disabled].jsx-843f2aed1d571725{background:#f0f0f0!important;color:#aaa!important;cursor:not-allowed!important}.err.jsx-843f2aed1d571725{color:#ff4f4f;font-size:.95em}"}),(0,t.jsx)("link",{rel:"stylesheet",href:"https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css",className:"jsx-843f2aed1d571725"})]})}var b=s(2088),f=s(4301);function u(){let[e,a]=(0,o.useState)([]),[s,r]=(0,o.useState)(null),[l,u]=(0,o.useState)(!1),[x,h]=(0,o.useState)(!0),[j,p]=(0,o.useState)(!1),[g,y]=(0,o.useState)("");(0,o.useEffect)(()=>{h(!0),(0,b.V1)().then(e=>{a(Array.isArray(e)?e:Array.isArray(null==e?void 0:e.data)?e.data:[]),y("")}).catch(()=>{y("Failed to fetch testimonials. Please try again later."),a([])}).finally(()=>h(!1))},[]);let N=async s=>{if(confirm("Delete this testimonial?")){p(!0);try{await (0,b.r$)(s),a(e.filter(e=>e.id!==s)),f.oR.success("Testimonial deleted successfully!")}catch(e){f.oR.error("Failed to delete testimonial.")}finally{p(!1)}a(e.filter(e=>e.id!==s))}},v=async e=>{p(!0);try{if(s){await (0,b.fI)(s.id,e);let t=await (0,b.V1)();a(Array.isArray(t)?t:t.data||[]),f.oR.success("Testimonial updated successfully!")}else{let s=await (0,b.GW)(e);console.log(s);let t=await (0,b.V1)();a(Array.isArray(t)?t:t.data||[]),f.oR.success("Testimonial created successfully!")}u(!1),r(null)}catch(e){console.error(e),f.oR.error("Failed to save testimonial.")}finally{p(!1)}};return(0,t.jsx)(i.A,{children:(0,t.jsxs)("div",{className:"jsx-ee3435a414c4bd5b admin-layout",children:[(0,t.jsx)(c.A,{}),(0,t.jsxs)("main",{className:"jsx-ee3435a414c4bd5b",children:[(0,t.jsx)(f.N9,{position:"top-right",autoClose:3e3}),(0,t.jsxs)("div",{className:"jsx-ee3435a414c4bd5b admin-header",children:[(0,t.jsx)("h1",{className:"jsx-ee3435a414c4bd5b",children:"Testimonials"}),!l&&(0,t.jsx)("button",{onClick:()=>{r(null),u(!0)},disabled:j,style:j?{opacity:.6,pointerEvents:"none"}:{},className:"jsx-ee3435a414c4bd5b add-btn",children:j&&!l?"Loading...":"+ Add Testimonial"})]}),l&&(0,t.jsx)(m,{initial:s,onSubmit:v,onCancel:()=>{u(!1),r(null)},loading:j}),g&&(0,t.jsx)("div",{style:{color:"#ff4f4f",marginBottom:"1rem",textAlign:"center"},className:"jsx-ee3435a414c4bd5b",children:g}),(0,t.jsx)(d,{testimonials:e,onEdit:e=>{r(e),u(!0)},onDelete:N,actionLoading:j}),x&&(0,t.jsx)("div",{style:{position:"absolute",left:0,top:0,width:"100%",height:"100%",background:"rgba(255,255,255,0.7)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:10},className:"jsx-ee3435a414c4bd5b",children:(0,t.jsx)("div",{style:{fontSize:18},className:"jsx-ee3435a414c4bd5b",children:"Loading..."})})]}),(0,t.jsx)(n(),{id:"ee3435a414c4bd5b",children:".admin-layout.jsx-ee3435a414c4bd5b{display:flex;min-height:100vh;background:#f5f7fb}main.jsx-ee3435a414c4bd5b{flex:1;padding:2rem}.admin-header.jsx-ee3435a414c4bd5b{display:flex;justify-content:space-between;align-items:center;margin-bottom:2rem}.add-btn.jsx-ee3435a414c4bd5b{background:#4f8cff;color:#fff;border:none;padding:.7rem 2rem;border-radius:4px;font-weight:600;cursor:pointer;font-size:1rem}.add-btn[disabled].jsx-ee3435a414c4bd5b{opacity:.6;cursor:not-allowed}@media(max-width:900px){main.jsx-ee3435a414c4bd5b{padding:1rem;width:70%}}"})]})})}s(6689)},2088:(e,a,s)=>{"use strict";function t(){return sessionStorage.getItem("admin_token")}async function r(){let e=t(),a=await fetch("".concat("https://live.maypascollege.com","/api/v1/admin/testimonial/get/all"),{headers:{Authorization:"Bearer ".concat(e)}});if(!a.ok)throw Error("Failed to fetch testimonials");let s=await a.json();return Array.isArray(s)?s:s.data||[]}async function n(e){let a=t(),s=new FormData;for(let a of(Object.entries(e).forEach(e=>{let[a,t]=e;s.append(a,t)}),s.entries()))console.log("FormData:",a[0],":",a[1]);let r=await fetch("".concat("https://live.maypascollege.com","/api/v1/contents/testimonial/create"),{method:"POST",headers:{Authorization:"Bearer ".concat(a),accept:"application/json"},body:s});if(console.log(r),!r.ok)throw Error("Failed to update testimonial");return r.json()}async function o(e,a){let s=t(),r=new FormData;Object.entries(a).forEach(e=>{let[a,s]=e;r.append(a,s)});let n=await fetch("".concat("https://live.maypascollege.com","/api/v1/contents/testimonial/update/").concat(e),{method:"POST",headers:{Authorization:"Bearer ".concat(s),accept:"application/json"},body:r});if(!n.ok)throw Error("Failed to update testimonial");return n.json()}async function i(e){let a=t(),s=await fetch("".concat("https://live.maypascollege.com","/api/v1/contents/testimonial/delete/").concat(e),{method:"POST",headers:{Authorization:"Bearer ".concat(a)}});if(!s.ok)throw Error("Failed to delete testimonial");return s.json()}s.d(a,{GW:()=>n,V1:()=>r,fI:()=>o,r$:()=>i})},6689:()=>{},8760:(e,a,s)=>{"use strict";function t(){return sessionStorage.getItem("admin_token")}async function r(){let e=t(),a=await fetch("".concat("https://live.maypascollege.com","/api/v1/courses/get"),{headers:{Authorization:"Bearer ".concat(e)}});if(!a.ok)throw Error("Failed to fetch courses list");let s=await a.json();return Array.isArray(s)?s:s.data||[]}async function n(e){let a=t(),s=new FormData;for(let a of(Object.entries(e).forEach(e=>{let[a,t]=e;"course_info_name[]"===a&&Array.isArray(t)?t.forEach(e=>s.append("course_info_name[]",e)):"course_info_value[]"===a&&Array.isArray(t)?t.forEach(e=>s.append("course_info_value[]",e)):"featured_image"===a&&t?t instanceof File?s.append("featured_image",t):Array.isArray(t)&&t.forEach(e=>s.append("featured_image",e)):s.append(a,t)}),s.entries()))console.log("FormData:",a[0],":",a[1]);console.log(e),console.log("Creating course with FormData:");let r=await fetch("".concat("https://live.maypascollege.com","/api/v1/contents/course/create"),{method:"POST",headers:{Authorization:"Bearer ".concat(a),Accept:"application/json"},body:s});if(console.log(r),!r.ok)throw Error("Failed to create course");return r.json()}async function o(e,a){let s=t(),r=new FormData;for(let e of(Object.entries(a).forEach(e=>{let[a,s]=e;"course_info_name[]"===a&&Array.isArray(s)?s.forEach(e=>r.append("course_info_name[]",e)):"course_info_value[]"===a&&Array.isArray(s)?s.forEach(e=>r.append("course_info_value[]",e)):"featured_image"===a&&s?s instanceof File?r.append("featured_image",s):Array.isArray(s)&&s.forEach(e=>r.append("featured_image",e)):r.append(a,s)}),r.entries()))console.log("FormData:",e[0],":",e[1]);let n=await fetch("".concat("https://live.maypascollege.com","/api/v1/contents/course/update/").concat(e),{method:"POST",headers:{Authorization:"Bearer ".concat(s),Accept:"application/json"},body:r});if(!n.ok)throw Error("Failed to update course");return n.json()}async function i(e){let a=t(),s=await fetch("".concat("https://live.maypascollege.com","/api/v1/contents/course/delete/").concat(e),{method:"POST",headers:{Authorization:"Bearer ".concat(a),"Content-Type":"application/json"}});if(!s.ok)throw Error("Failed to delete course");return s.json()}s.d(a,{C_:()=>n,D:()=>r,J4:()=>o,zs:()=>i})}},e=>{e.O(0,[4938,9008,3835,1978,636,6593,8792],()=>e(e.s=314)),_N_E=e.O()}]);